schema:
  required_cols: [ret_1d_lag1, sma_10, sma_20, vol_10, rsi_14]
  dtypes:
    ret_1d_lag1: float64
    sma_10: float64
    sma_20: float64
    vol_10: float64
    rsi_14: float64

row_rules:
  - id: non_null_all
    kind: non_null
    cols: [ret_1d_lag1, sma_10, sma_20, vol_10, rsi_14]

  - id: finite_all
    kind: finite
    cols: [ret_1d_lag1, sma_10, sma_20, vol_10, rsi_14]

  # Strict bounds for real market data
  - id: rsi_bounds
    kind: range
    col: rsi_14
    min: 0
    max: 100

  - id: vol_nonneg
    kind: min
    col: vol_10
    min: 0

  - id: ret_reasonable_daily
    kind: range_soft
    col: ret_1d_lag1
    min: -0.2
    max: 0.2

dataset_rules:
  - id: no_duplicate_rows
    kind: no_dupes
    subset: [ret_1d_lag1, sma_10, sma_20, vol_10, rsi_14]

  - id: leakage_guard_label_shift
    kind: no_future_leak
    features: [ret_1d_lag1, sma_10, sma_20, vol_10, rsi_14]
    label_col: y
    lookahead_bars: 1

thresholds:
  soft_fail_fraction: 0.005   # 0.5% rows can violate soft rules (strict)
