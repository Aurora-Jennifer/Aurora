name: Model Eval
on:
  pull_request:
    paths:
      - "ml/**"
      - "tools/**"
      - "config/models.yaml"
      - "reports/**"
      - "artifacts/models/**"
  schedule:
    - cron: "17 3 * * *"

jobs:
  eval:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with: { python-version: "3.11", cache: "pip" }
      - run: pip install -r requirements.txt
      - run: python tools/gen_dummy_model.py
      - run: pytest -q tests/ml/test_model_golden.py tests/ml/test_feature_stats.py
      - run: python tools/monitor_model_drift.py
      - run: python tools/validate_model_metrics.py reports/model_drift.json
      - uses: actions/upload-artifact@v4
        with: { name: model-eval, path: reports/model_drift.json }


